# Compound Oracle: ç»Ÿä¸€çŸ¥è¯†å¤åˆ©å¬å›æŠ€èƒ½æ–¹æ¡ˆ (Solution A)

## 0. èƒŒæ™¯ä¸æ„¿æ™¯
åœ¨ Compound Engineering ä½“ç³»ä¸­ï¼Œ`/workflow:compound` æ²‰æ·€äº†å¤§é‡é«˜è´¨é‡çš„è§£å†³æ–¹æ¡ˆå’Œæ³¨æ„äº‹é¡¹ã€‚ç„¶è€Œï¼Œç›®å‰çš„çŸ¥è¯†å¤„äºâ€œåªå­˜ä¸å–â€çš„é™æ€çŠ¶æ€ã€‚

**Compound Oracle** æŠ€èƒ½çš„ç›®æ ‡æ˜¯æ¨¡ä»¿ Claude å®˜æ–¹æŠ€èƒ½çš„â€œå¾ªåºæ¸è¿›â€è®¾è®¡æ¨¡å¼ï¼Œå°†æ²‰æ·€çš„çŸ¥è¯†è½¬åŒ–ä¸ºâ€œæ´»æ€§èµ„äº§â€ã€‚å®ƒé€šè¿‡ä¸€ä¸ªç»Ÿä¸€çš„å…¥å£ï¼Œåœ¨ä¸ç‰ºç‰²ä¸Šä¸‹æ–‡çª—å£çš„å‰æä¸‹ï¼Œä¸º AI èµ‹äºˆâ€œé¡¹ç›®è®°å¿†â€ï¼Œä½¿å…¶åœ¨æ‰§è¡Œç›¸å…³ä»»åŠ¡æ—¶è‡ªåŠ¨é¿å‘ã€‚

---

## 1. æ ¸å¿ƒè®¾è®¡å“²å­¦ï¼šæ¸è¿›å¼æŠ«éœ² (Progressive Disclosure)

æ–¹æ¡ˆé‡‡ç”¨ä¸‰å±‚åŠ è½½æ¶æ„ï¼Œç¡®ä¿åªæœ‰åœ¨çœŸæ­£éœ€è¦æ—¶æ‰åŠ è½½è¯¦ç»†å†…å®¹ï¼š

| å±‚çº§ | è½½ä½“ | åŠ è½½æ—¶æœº | ä½œç”¨ |
| :--- | :--- | :--- | :--- |
| **Layer 1: æ„ŸçŸ¥å±‚** | `name` & `description` | **å§‹ç»ˆåœ¨åœº** | å‘Šè¯‰ç³»ç»Ÿï¼šâ€œæˆ‘æœ‰é¡¹ç›®å†å²ç»éªŒï¼Œé‡åˆ°åˆ›å»º/è®¾è®¡ä»»åŠ¡è¯·æ‰¾æˆ‘ã€‚â€ |
| **Layer 2: è·¯ç”±å±‚** | `SKILL.md` æ­£æ–‡ | **è§¦å‘æ—¶åŠ è½½** | åŒ…å«â€œä»»åŠ¡ -> å¼•ç”¨æ–‡ä»¶â€çš„æ˜ å°„è¡¨ï¼Œå†³å®šè¯»å–å“ªä¸ªå…·ä½“çš„çŸ¥è¯†ç‚¹ã€‚ |
| **Layer 3: è½½è·å±‚** | `references/*.md` | **æŒ‰éœ€åŠ è½½** | å…·ä½“çš„å‘ç‚¹ï¼ˆPitfallsï¼‰ã€æ³¨æ„äº‹é¡¹ï¼ˆPrecautionsï¼‰å’Œä»£ç è§„çº¦ã€‚ |

---

## 2. ç›®å½•ç»“æ„è§„èŒƒ

```text
plugins/compound-engineering/skills/compound-oracle/
â”œâ”€â”€ SKILL.md                 # æ ¸å¿ƒæŠ€èƒ½å®šä¹‰ï¼ŒåŒ…å«è·¯ç”±é€»è¾‘
â”œâ”€â”€ references/              # åˆ†é¢†åŸŸçŸ¥è¯†åº“ï¼ˆPayload å±‚ï¼‰
â”‚   â”œâ”€â”€ agent-engineering.md   # é‡ç‚¹ï¼šæ™ºèƒ½ä½“åˆ›å»ºçš„æ³¨æ„äº‹é¡¹ä¸å‘ç‚¹
â”‚   â”œâ”€â”€ database-patterns.md   # æ•°æ®åº“è¿ç§»ä¸æ€§èƒ½æœ€ä½³å®è·µ
â”‚   â””â”€â”€ frontend-standards.md  # UI ç»„ä»¶ä¸ CSS è§„çº¦
â””â”€â”€ assets/
    â””â”€â”€ knowledge-index.json   # (å¯é€‰) ç»“æ„åŒ–çš„å…ƒæ•°æ®ç´¢å¼•
```

---

## 3. è¯¦ç»†å±‚çº§è®¾è®¡

### Layer 1: å…ƒæ•°æ® (Metadata)
å®šä¹‰åœ¨ `SKILL.md` çš„ YAML Frontmatter ä¸­ï¼š

```yaml
name: compound-oracle
description: "æ­¤æŠ€èƒ½ä½œä¸ºé¡¹ç›®æœºæ„åŒ–è®°å¿†çš„å”¯ä¸€å‡ºå£ã€‚å½“ä½ åœ¨è¿›è¡Œè§„åˆ’ (Planning)ã€è®¾è®¡ (Designing) æˆ–å®ç° (Implementing) ä»»åŠ¡æ—¶ï¼Œå¿…é¡»ä½¿ç”¨æ­¤æŠ€èƒ½æ¥å¬å›æœ¬é¡¹ç›®çš„å†å²ç»éªŒã€æ³¨æ„äº‹é¡¹ (Precautions) å’Œå·²çŸ¥å‘ç‚¹ (Pitfalls)ï¼Œç‰¹åˆ«æ˜¯æ¶‰åŠ Agent å¼€å‘ã€æ•°æ®åº“å˜æ›´æˆ–å‰ç«¯æ¶æ„æ—¶ã€‚"
```

### Layer 2: è·¯ç”±é€»è¾‘ (Router)
å®šä¹‰åœ¨ `SKILL.md` çš„æŒ‡ä»¤éƒ¨åˆ†ï¼š

```markdown
## çŸ¥è¯†å¬å›åè®® (Recall Protocol)

å½“ä»»åŠ¡å¼€å§‹æ—¶ï¼Œè¯·æŒ‰é¡ºåºæ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š

1. **æå–é¢†åŸŸ (Domain Extraction)**: è¯†åˆ«å½“å‰ä»»åŠ¡æ‰€å±çš„é¢†åŸŸï¼ˆä¾‹å¦‚ï¼šAgent, Database, UIï¼‰ã€‚
2. **è·¯ç”±æŸ¥æ‰¾ (Routing)**: æ ¹æ®é¢†åŸŸåœ¨ä¸‹è¡¨ä¸­æŸ¥æ‰¾å¯¹åº”çš„å‚è€ƒæ–‡ä»¶ï¼š
   | é¢†åŸŸå…³é”®è¯ | å‚è€ƒæ–‡ä»¶ (Reference File) |
   | :--- | :--- |
   | agent, tool, identity, agentic | `references/agent-engineering.md` |
   | migration, sql, active_record | `references/database-patterns.md` |
   | react, component, tailwind | `references/frontend-standards.md` |
3. **ç²¾å‡†è¯»å– (Targeted Read)**: ä»…è°ƒç”¨ `read_file` è¯»å–é€šè¿‡è·¯ç”±åŒ¹é…åˆ°çš„ä¸€ä¸ªå‚è€ƒæ–‡ä»¶ã€‚
4. **æ³¨å…¥çº¦æŸ (Constraint Injection)**: å°†æ–‡ä»¶ä¸­çš„â€œPrecautionsâ€å’Œâ€œPitfallsâ€è½¬åŒ–ä¸ºå½“å‰ä»»åŠ¡çš„å¼ºåˆ¶çº¦æŸã€‚
```

### Layer 3: çŸ¥è¯†è½½è· (Payload - ä»¥ Agent åˆ›å»ºä¸ºä¾‹)
æ–‡ä»¶è·¯å¾„ï¼š`references/agent-engineering.md`

```markdown
# Agent å·¥ç¨‹æ³¨æ„äº‹é¡¹ä¸å‘ç‚¹

## ğŸ¯ Precautions (æ³¨æ„äº‹é¡¹)
- **å­ä»£ç†ç²’åº¦**: ä¼˜å…ˆåˆ›å»ºèŒè´£å•ä¸€çš„å°è§„æ¨¡ Sub-agentï¼Œé¿å…åˆ›å»ºä¸‡èƒ½ Agentã€‚
- **åè®®ä¸€è‡´æ€§**: æ‰€æœ‰çš„ Sub-agent å¿…é¡»éµå¾ªç»Ÿä¸€çš„è¿”å›æ ¼å¼ï¼ˆå¦‚ JSON æˆ–ç‰¹å®š Markdown Tagï¼‰ã€‚

## âš ï¸ Pitfalls (å·²çŸ¥å‘ç‚¹)
- **Token æº¢å‡ºé£é™©**: åœ¨å†å²æ²‰æ·€ä¸­å‘ç°ï¼ˆè§ #sol-001ï¼‰ï¼Œå¦‚æœ Sub-agent çš„ prompt è¶…è¿‡ 5k tokens ä¸”æ²¡æœ‰æˆªæ–­é€»è¾‘ï¼Œä¼šå¯¼è‡´å›å¤è´¨é‡æ–­å´–å¼ä¸‹è·Œã€‚
- **å¾ªç¯è°ƒç”¨**: ä¸¥ç¦ä¸¤ä¸ª Sub-agent ä¹‹é—´ç›¸äº’è°ƒç”¨ï¼Œå¿…é¡»ç”± Orchestrator ç»Ÿä¸€è°ƒåº¦ï¼ˆæ›¾ç»å‘ç”Ÿçš„æ­»å¾ªç¯æ•™è®­è§ #sol-042ï¼‰ã€‚
```

---

## 4. è‡ªåŠ¨åŒ–é—­ç¯ï¼šä¸ `/workflow:compound` é›†æˆ

ä¸ºäº†ä¿æŒçŸ¥è¯†çš„æ›´æ–°ï¼Œæˆ‘ä»¬éœ€è¦å»ºç«‹è‡ªåŠ¨åŒ–åŒæ­¥æœºåˆ¶ï¼š

1. **æ²‰æ·€æ—¶è§¦å‘**: æ‰§è¡Œ `/workflow:compound` åï¼Œç³»ç»Ÿä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„è§£å†³æ–¹æ¡ˆæ–‡æ¡£ã€‚
2. **åˆ†ç±»ä¸è¿½åŠ **: ç³»ç»Ÿæ£€æµ‹è¯¥æ–¹æ¡ˆæ˜¯å¦åŒ…å«â€œPrecautionsâ€æˆ–â€œPitfallsâ€æ ‡ç­¾ã€‚
3. **æ›´æ–°ç´¢å¼•**: å¦‚æœæœ‰ï¼Œç”± `scripts/index_updater.py` è‡ªåŠ¨å°†å…¶æ ¸å¿ƒç‚¹æå–åˆ° `compound-oracle/references/` ä¸‹å¯¹åº”çš„é¢†åŸŸæ–‡ä»¶ä¸­ã€‚

---

## 5. æ–¹æ¡ˆä¼˜åŠ¿æ€»ç»“ (Solution A vs Solution B)

- **é¿å…ä¸Šä¸‹æ–‡çˆ†ç‚¸**: åªæœ‰ 1 ä¸ªå…¬å…± Skill çš„ Metadata å§‹ç»ˆé©»ç•™ã€‚å³ä½¿æœ‰ 1000 ä¸ªå‘ç‚¹æ–‡æ¡£ï¼Œä¹Ÿåªæœ‰è¢«å‘½ä¸­çš„é‚£ä¸€ä¸ªä¼šè¢«åŠ è½½ã€‚
- **è¯­ä¹‰å¬å›æ›´å¼º**: å…¬å…± Skill çš„æè¿°å¯ä»¥å†™å¾—æ›´å…·â€œæ¦‚æ‹¬æ€§â€ï¼Œæé«˜åœ¨ Claude å†…éƒ¨çš„æƒé‡ï¼Œé¿å…å¾®å‹ Skill ä¹‹é—´äº’ç›¸å¹²æ‰°ã€‚
- **ç»´æŠ¤æˆæœ¬ä½**: æ— éœ€é¢‘ç¹åˆ›å»ºæ–° Skill æ–‡ä»¶å¤¹ï¼Œåªéœ€è¦ç»´æŠ¤å•ä¸€ Skill ä¸‹çš„ `references/` æ–‡ä»¶å¤¹ã€‚

---

**ç»“è®º**ï¼šè¯¥æ–¹æ¡ˆå°† **Compound Engineering** ä»ä¸€ä¸ªâ€œè®°å½•å·¥å…·â€å‡çº§ä¸ºä¸€ä¸ªå…·æœ‰â€œå®æ—¶åé¦ˆèƒ½åŠ›â€çš„**å·¥ç¨‹æ“ä½œç³»ç»Ÿ**ã€‚
