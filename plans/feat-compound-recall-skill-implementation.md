# feat: Compound Recall Skill å®ç°

## å®æ–½çŠ¶æ€: âœ… å·²å®Œæˆ

> **å®ç°å˜æ›´è¯´æ˜**  
> åŸè®¡åˆ’é‡‡ç”¨é™æ€ç´¢å¼•æ–¹æ¡ˆ (`knowledge-index.json`)ï¼Œå®é™…é‡‡ç”¨ **Flash Recall åŠ¨æ€æ‰«ææ–¹æ¡ˆ**ã€‚  
> **å˜æ›´åŸå› **ï¼šé¿å… Git å†²çªï¼Œå®ç°é›¶ç»´æŠ¤çš„å³æ—¶çŸ¥è¯†å¬å›ã€‚å›¢é˜Ÿæˆå‘˜ `git pull` åï¼Œæ–°å¢çš„ solution æ–‡æ¡£ç«‹å³å¯è¢«å¬å›ã€‚  
> **æ ¸å¿ƒå®ç°**ï¼š`recall_matcher.py` å®æ—¶æ‰«æ `docs/solutions/*.md`ï¼Œæ— éœ€æ‰‹åŠ¨ç»´æŠ¤ç´¢å¼•æ–‡ä»¶ã€‚

## æ¦‚è¿°

å®ç° compound çŸ¥è¯†åº“çš„ä¸»åŠ¨å¬å›æœºåˆ¶,ä½¿æ²‰æ·€åœ¨ `docs/solutions/` ä¸­çš„çŸ¥è¯†èƒ½å¤Ÿåƒ skill ä¸€æ ·è¢«è‡ªåŠ¨å‘ç°å’Œåº”ç”¨,çœŸæ­£å‘æŒ¥çŸ¥è¯†å¤åˆ©æ•ˆåº”ã€‚

**å½“å‰çŠ¶æ€**:
- âœ… å¼ºå¤§çš„çŸ¥è¯†æ²‰æ·€ç³»ç»Ÿ (`/workflow:compound` å‘½ä»¤ + 6ä¸ªå¹¶è¡Œå­ä»£ç†)
- âœ… ä¸‰çº§çŸ¥è¯†åˆ†å±‚ (L1æ–‡æ¡£ â†’ L2æ¨¡å¼ â†’ L3 Skill)
- âœ… L1å±‚(docs/solutions/) **ä¸»åŠ¨å¬å›å·²å®ç°** (Flash Recall)

**ç›®æ ‡çŠ¶æ€**:
- âœ… çŸ¥è¯†åƒ skill ä¸€æ ·è‡ªåŠ¨å¬å›
- âœ… AI åœ¨è§„åˆ’/å¼€å‘/å®¡æŸ¥æ—¶ä¸»åŠ¨æ¨èç›¸å…³å†å²æ–¹æ¡ˆ
- âœ… é‡å¤é—®é¢˜è§£å†³æ—¶é—´ä» 20åˆ†é’Ÿ é™è‡³ 5åˆ†é’Ÿ

## é—®é¢˜é™ˆè¿°

### ç—›ç‚¹åˆ†æ

**ç°çŠ¶é—®é¢˜**:
1. **è¢«åŠ¨çŸ¥è¯†åº“**: é«˜è´¨é‡æ–‡æ¡£æ²‰æ·€åœ¨ `docs/solutions/`,ä½†éœ€è¦"è®°å¾—å»æŸ¥"
2. **ç¼ºå°‘è‡ªåŠ¨å‘ç°**: ä¸åƒ skill é‚£æ ·åŸºäº name/description è‡ªåŠ¨åŒ¹é…ä»»åŠ¡
3. **çŸ¥è¯†å­¤å²›**: æ¯æ¬¡é‡åˆ°é—®é¢˜éƒ½éœ€è¦æ‰‹åŠ¨æœç´¢,æ— æ³•ä¸»åŠ¨é¿å‘
4. **å¤åˆ©æ•ˆåº”ç¼ºå¤±**: ç¬¬ä¸€æ¬¡è§£å†³é—®é¢˜ 30åˆ†é’Ÿ,ç¬¬äºŒæ¬¡è¿˜è¦ 20åˆ†é’Ÿ

**æ ¸å¿ƒå·®å¼‚**: CompoundçŸ¥è¯†æ˜¯**è¢«åŠ¨çŸ¥è¯†åº“**,Skillæ˜¯**ä¸»åŠ¨ä»£ç†æ‰©å±•**

| ç»´åº¦ | CompoundçŸ¥è¯† | Skillæœºåˆ¶ |
|------|-------------|----------|
| è‡ªåŠ¨å‘ç° | âŒ æ—  | âœ… name/descriptionå§‹ç»ˆåœ¨context |
| ä¸»åŠ¨å¬å› | âŒ ä»…è¢«åŠ¨æŸ¥æ‰¾ | âœ… ä¸»åŠ¨åŒ¹é…ä»»åŠ¡ |
| è§¦å‘æ—¶æœº | éœ€äººå·¥è®°å¿†/æœç´¢ | ä»»åŠ¡å…³é”®è¯è‡ªåŠ¨è§¦å‘ |

## æè®®æ–¹æ¡ˆ

### æ–¹æ¡ˆé€‰æ‹©: Compound Recall Skill (æ¨è â­)

é‡‡ç”¨**æ¸è¿›å¼æŠ«éœ²(Progressive Disclosure)**è®¾è®¡,åˆ›å»ºç»Ÿä¸€çš„ `compound-recall` skillã€‚

**æ ¸å¿ƒæ€è·¯**: ä¸‰å±‚åŠ è½½æ¶æ„,å°† `docs/solutions/` åŠ¨æ€è½¬åŒ–ä¸ºæ´»æ€§èµ„äº§ã€‚

```
Layer 1 (æ„ŸçŸ¥å±‚): name + description          # å§‹ç»ˆåœ¨context (~100 words)
    â†“
Layer 2 (è·¯ç”±å±‚): SKILL.md æ­£æ–‡               # è§¦å‘æ—¶åŠ è½½ (~2k words), å®šä¹‰æ£€ç´¢é€»è¾‘
    â†“
Layer 3 (è½½è·å±‚): references/index.json       # æŒ‰éœ€æ˜ å°„åˆ° docs/solutions/*.md
```

**ä¼˜åŠ¿**:
- âœ… **åŠ¨æ€åŒæ­¥**: åŸºäº `docs/solutions/` è‡ªåŠ¨ç”Ÿæˆç´¢å¼•,æ— éœ€æ‰‹åŠ¨ç»´æŠ¤å†…å®¹æ–‡ä»¶ã€‚
- âœ… **é¿å…ä¸Šä¸‹æ–‡çˆ†ç‚¸**: åªåŠ è½½åŒ¹é…çš„å¼•ç”¨æ–‡ä»¶å†…å®¹ã€‚
- âœ… **è¯­ä¹‰å¬å›æ›´å¼º**: ç»Ÿä¸€æè¿°æé«˜ä»»åŠ¡åŒ¹é…æƒé‡ã€‚

## æŠ€æœ¯æ¶æ„

### ç›®å½•ç»“æ„

```
plugins/native-engineering/skills/compound-recall/
â”œâ”€â”€ SKILL.md                      # æ ¸å¿ƒæ£€ç´¢ä¸æ³¨å…¥é€»è¾‘
â”œâ”€â”€ references/                   # ç´¢å¼•ä¸æ˜ å°„ (Payload å±‚)
â”‚   â”œâ”€â”€ knowledge-index.json      # è‡ªåŠ¨ç”Ÿæˆçš„ç»“æ„åŒ–ç´¢å¼• (Mapping)
â”‚   â””â”€â”€ taxonomy.md               # é¢†åŸŸåˆ†ç±»ä¸å…³é”®è¯æŒ‡å—
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ index_solutions.py        # æ ¸å¿ƒè„šæœ¬ï¼šæ‰«æ docs/solutions/ ç”Ÿæˆç´¢å¼•
â””â”€â”€ assets/
    â””â”€â”€ recall-template.md        # å¬å›å†…å®¹æ³¨å…¥æ¨¡æ¿
```

### æ ¸å¿ƒå·¥ä½œæµç¨‹

```mermaid
graph TB
    A[ç”¨æˆ·ä»»åŠ¡] --> B{Compound Recall è§¦å‘}
    B -->|åŒ¹é…å…³é”®è¯| C[åŠ è½½ SKILL.md]
    C --> D[æ‰§è¡Œç´¢å¼•æŸ¥è¯¢]
    D --> E{åŒ¹é…æˆåŠŸ?}
    E -->|Yes| F[è¯»å– docs/solutions/ å¯¹åº” MD]
    E -->|No| G[åé¦ˆ: æœªå‘ç°ç›¸å…³ç»éªŒ]
    F --> H[å°† Pitfalls/Precautions æ³¨å…¥å½“å‰ä»»åŠ¡]
    H --> I[æ‰§è¡Œä»»åŠ¡æ—¶åº”ç”¨çŸ¥è¯†]
```

## æŠ€æœ¯è€ƒè™‘å› ç´ 

### æ£€ç´¢ç­–ç•¥

**ä¸‰é‡åŒ¹é…ç®—æ³• (Triple-Match Algorithm)**:

1. **ç²¾ç¡®åŒ¹é… (Exact Match)**: é”™è¯¯æ¶ˆæ¯(Error Signature)ç²¾ç¡®åŒ¹é… - æƒé‡ 50%
2. **æ ‡ç­¾åŒ¹é… (Tag Match)**: æŠ€æœ¯æ ˆ/ç»„ä»¶æ ‡ç­¾äº¤é›† - æƒé‡ 30%
3. **è¯­ä¹‰å…³é”®è¯åŒ¹é…**: ç—‡çŠ¶ã€æ¨¡å—å…³é”®è¯ç›¸ä¼¼åº¦ - æƒé‡ 20%

### ç´¢å¼• Schema è®¾è®¡ (`references/knowledge-index.json`)

```json
{
  "version": "1.0",
  "last_updated": "2026-01-18T00:00:00Z",
  "solutions": [
    {
      "id": "perf-001",
      "path": "docs/solutions/performance-issues/redis-cache-stampede.md",
      "metadata": {
        "tags": ["redis", "caching", "race-condition"],
        "symptoms": ["Sudden database spike", "Cache miss storm"],
        "root_cause": "Missing race_condition_handling",
        "error_signatures": ["Redis::TimeoutError"]
      }
    }
  ],
  "tag_index": {
    "redis": ["perf-001"],
    "rails": ["perf-001"]
  }
}
```

## æ¥å—æ ‡å‡†

### åŠŸèƒ½éœ€æ±‚

- [x] **Skill åˆ›å»º**: åˆ›å»º `compound-recall` skill,åŒ…å« YAML frontmatter å’ŒåŠ¨æ€æ£€ç´¢æŒ‡ä»¤ã€‚
- [x] **åŠ¨æ€æ‰«æ**: å®ç° `scripts/recall_matcher.py`,èƒ½å®æ—¶ä» `docs/solutions/` æ‰«æå’ŒåŒ¹é… metadataã€‚*(æ³¨ï¼šé‡‡ç”¨ Flash Recall æ›¿ä»£é™æ€ç´¢å¼•)*
- [x] **åŠ¨æ€è·¯ç”±**: `compound-recall` èƒ½æ ¹æ®åŒ¹é…ç»“æœæ­£ç¡®å®šä½åˆ°å¯¹åº”çš„ç‰©ç†æ–‡ä»¶è·¯å¾„ã€‚
- [x] **é—­ç¯é›†æˆ**: æ— éœ€æ‰‹åŠ¨æ›´æ–°ç´¢å¼•ï¼Œæ–°æ–‡æ¡£ `git pull` åç«‹å³å¯å¬å›ã€‚

### é›†æˆéœ€æ±‚

- [x] **Planning é›†æˆ**: `/workflow:plan` ç”Ÿæˆè§„åˆ’å‰è‡ªåŠ¨è°ƒç”¨ `compound-recall-researcher`ã€‚
- [x] **Work é›†æˆ**: `/workflow:work` Phase 2 æ‰§è¡Œå‰ä¸»åŠ¨é¢„æ£€ + é‡åˆ°æŠ¥é”™æ—¶è‡ªåŠ¨æ£€æŸ¥ç›¸å…³ç»éªŒã€‚
- [x] **Review é›†æˆ**: `/workflow:review` å®¡æŸ¥æ—¶è‡ªåŠ¨è°ƒç”¨ `compound-recall-researcher` æ£€æŸ¥æ˜¯å¦è§¦çŠ¯è¿‡å¾€å·²çŸ¥ Pitfallsã€‚

---

## å®æ–½è®¡åˆ’

### Phase 1: ç´¢å¼•å¼•æ“ä¸åŸºç¡€ Skill (2å¤©)

**ç›®æ ‡**: å®ç°â€œåªè¯»ç´¢å¼•â€å¬å›èƒ½åŠ›,æ— éœ€æ‰‹åŠ¨å†™å‚è€ƒæ–‡ä»¶ã€‚

1. **å®ç°ç´¢å¼•è„šæœ¬** (6å°æ—¶)
   - [ ] ç¼–å†™ `scripts/index_solutions.py`ã€‚
   - [ ] æ‰«æ `docs/solutions/` æ‰€æœ‰ MD,æå– YAML metadataã€‚
   - [ ] ç”Ÿæˆ `references/knowledge-index.json`ã€‚

2. **åˆ›å»º Compound Recall Skill** (4å°æ—¶)
   - [ ] `skills/compound-recall/SKILL.md`ã€‚
   - [ ] å®šä¹‰æ„ŸçŸ¥å±‚æè¿°:â€œé¡¹ç›®å†å²çŸ¥è¯†æ£€ç´¢å‡ºå£â€ã€‚
   - [ ] ç¼–å†™æŒ‡ä»¤:å¦‚ä½•è¯»å– JSON ç´¢å¼•å¹¶æ˜ å°„åˆ°ç‰©ç†æ–‡ä»¶ã€‚

3. **é›†æˆè‡ªåŠ¨åŒ–æ›´æ–°** (2å°æ—¶)
   - [ ] åœ¨ `compound-docs` skill çš„ Step 7 åŠ å…¥ `python3 scripts/index_solutions.py`ã€‚

### Phase 2: æ£€ç´¢ç®—æ³•ä¸æ£€ç´¢æ³¨å…¥ (2å¤©)

**ç›®æ ‡**: æå‡å¬å›ç›¸å…³åº¦,å¹¶å®ç°æ— æ„Ÿæ³¨å…¥ã€‚

1. **ä¼˜åŒ–æ£€ç´¢é€»è¾‘** (6å°æ—¶)
   - [ ] åœ¨ `SKILL.md` ä¸­å¼ºåŒ–â€œé”™è¯¯ç­¾åä¼˜å…ˆâ€åŒ¹é…åŸåˆ™ã€‚
   - [ ] å¤„ç†â€œæœªæ‰¾åˆ°â€æ—¶çš„é™çº§ç­–ç•¥(æ¨¡ç³Šå…³é”®è¯æœç´¢)ã€‚

2. **æ³¨å…¥æ¨¡æ¿å®ç°** (4å°æ—¶)
   - [ ] å®šä¹‰æ³¨å…¥æ ¼å¼,ç¡®ä¿ AI çŸ¥é“å“ªäº›æ˜¯â€œè¿‡å¾€æ•™è®­â€éœ€å¼ºåˆ¶éµå®ˆã€‚

### Phase 3: Workflow æ·±åº¦é›†æˆ (3å¤©)

**ç›®æ ‡**: åœ¨ç”¨æˆ·æ— æ„Ÿçš„æƒ…å†µä¸‹,çŸ¥è¯†è‡ªåŠ¨æµ®ç°ã€‚

1. **è§„åˆ’é›†æˆ** (4å°æ—¶)
   - [ ] ä¿®æ”¹ `/workflow:plan`,åœ¨è°ƒç ”é˜¶æ®µè‡ªåŠ¨è°ƒç”¨ `compound-recall`ã€‚

2. **ä»»åŠ¡é›†æˆ** (4å°æ—¶)
   - [ ] ä¿®æ”¹ `/workflow:work`,åœ¨æ‰§è¡ŒæŠ¥é”™æ—¶è§¦å‘å¬å›ã€‚

3. **æµ‹è¯•ä¸éªŒæ”¶** (8å°æ—¶)
   - [ ] æ¨¡æ‹Ÿâ€œå¤ç° Bug -> è¢«è‡ªåŠ¨æç¤º -> å¿«é€Ÿè§£å†³â€çš„é—­ç¯æµ‹è¯•ã€‚

---

## æˆåŠŸæŒ‡æ ‡

- âœ… **é›¶æ‰‹åŠ¨ç»´æŠ¤**: reference å†…å®¹å®Œå…¨ç”± `docs/solutions/` è‡ªåŠ¨ç”Ÿæˆã€‚
- âœ… **ç§’çº§æ›´æ–°**: æ–°è®°å½•çš„ solution åœ¨ 5 ç§’å†…å¯è¢«åç»­ä»»åŠ¡å¬å›ã€‚
- âœ… **ç²¾å‡†åº¦**: å¬å›æ–‡æ¡£ä¸å½“å‰ä»»åŠ¡çš„ç›¸å…³åº¦ >80%ã€‚

ğŸ¤– Generated with [Claude Code](https://claude.com/claude-code)
